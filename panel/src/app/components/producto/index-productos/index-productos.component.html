<div class="d-flex flex-column flex-root">
    <div class="d-flex flex-row flex-column-fluid page">
        <app-sidebar></app-sidebar>
        <div class="d-flex flex-column flex-row-fluid wrapper" id="kt_wrapper">
            <app-top></app-top>
            <!--begin::Content-->
            <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                <!--begin::Subheader-->
                <div class="subheader py-2 py-lg-4 subheader-solid" id="kt_subheader">
                    <div class="container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
                        <!--begin::Info-->
                        <div class="d-flex align-items-center flex-wrap mr-2">
                            <!--begin::Page Title-->
                            <h5 class="text-dark font-weight-bold mt-2 mb-2 mr-5">Productos</h5>
                            <!--end::Page Title-->
                            <!--begin::Actions-->
                            <div class="subheader-separator subheader-separator-ver mt-2 mb-2 mr-4 bg-gray-200"></div>
                            <span class="text-muted font-weight-bold mr-4">#XRS-45670</span>
                            <a href="#" class="btn btn-light-warning font-weight-bolder btn-sm">Add New</a>
                            <!--end::Actions-->
                        </div>
                        <!--end::Info-->
                        
                    </div>
                </div>
                <!--end::Subheader-->
                <!--begin::Entry-->
                <div class="d-flex flex-column-fluid">
                    <!--begin::Container-->
                    <div class="container">
                        <div class="card card-custom gutter-b">
                            <!--begin::Header-->
                            <div class="card-header flex-wrap border-0 pt-6 pb-0">
                                <h3 class="card-title align-items-start flex-column">
                                    <span class="card-label font-weight-bolder font-size-h3 text-dark">Productos</span>
                                </h3>
                                <div class="card-toolbar">
                                    <div class="dropdown dropdown-inline">
                                        <a data-toggle="modal" data-target="#exampleModalCenter" class="btn btn-primary font-weight-bolder font-size-sm">Nuevo producto</a>
                                    </div>
                                </div>
                            </div>
                            <!--end::Header-->
                            <div class="card-body">
                                <!--begin::Shopping Cart-->
            
                                <div class="mb-7" >
                                    <div class="row align-items-center">
                                        <div class="col-lg-9 col-xl-8">
                                            <div class="row align-items-center">
                                                <div class="col-md-6 my-2 my-md-0">
                                                    <div class="input-group">
                                                        <input type="text" class="form-control" placeholder="Buscar" name="filtro_producto" [(ngModel)]="filtro_producto">
                                                        <div class="input-group-append">
                                                            <button class="btn btn-primary" type="button" (click)="filtrar_data()">Buscar</button>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
            
            
                                <div class="table-responsive">
                                    <table class="table table-head-custom table-head-bg table-borderless table-vertical-center" style="margin-bottom: 0px;">
                                        <!--begin::Cart Header-->
                                        <thead>
                                            <tr class="text-left text-uppercase">
                                                <th style="min-width: 100px">CODIGO</th>
                                                <th style="min-width: 250px" class="pl-7">
                                                    <span class="text-dark-75">Descripción</span>
                                                </th>
                                                <th style="min-width: 100px">Precio</th>
                                                <th style="min-width: 100px">Tipo</th>
                                                <th style="min-width: 50px">Unidad de Medida</th> 
                                                <th style="min-width: 100px">Acciones</th>   
                                            </tr>
                                        </thead>
                                        
                                        <!--end::Cart Header-->
                                        <ng-container *ngIf="load_data">
                                            <tbody>
                                                <tr>
                                                    <td class="text-center" colspan="6">
                                                        <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
                                                            <span class="sr-only">Cargando...</span>
                                                          </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </ng-container>
                                        <ng-container *ngIf="!load_data">
                                            <tbody *ngFor="let item of producto | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize">
                                                <!--begin::Cart Content-->
                                                <tr>                                                    
                                                    <td>
                                                        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{item.codigo}}</span>                                                      
                                                    </td>
                                                    <td>
                                                        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{item.descripcion}}</span>                                                        
                                                    </td>
                                                    <td>
                                                        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{item.precio|currency:'Q'}}</span>                                                                                  
                                                    </td>
                                                    <td>
                                                        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{item.tipo}}</span>
                                                    </td>
                                                    <td class="text-center">
                                                        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{item.unidad}}</span>
                                                    </td>
                                                    <td>
                                                        <div class="dropdown dropleft">
                                                            <button type="button" class="btn btn-light-primary btn-icon btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                <i class="ki ki-bold-more-ver"></i>
                                                            </button>
                                                            <div class="dropdown-menu">                                                                
                                                                <!--Esto lleva a crear el path en el Frontend - app.routing.ts /colaborador/:id-->
                                                                <a style="cursor: pointer;" class="dropdown-item" (click)="openEditModal(item._id)">
                                                                    <i class="icon-1x text-dark-50 flaticon-edit"></i> &nbsp; Editar
                                                                </a>
                                                                <a style="cursor: pointer;" class="dropdown-item" data-toggle="modal" [attr.data-target]="'#delete-'+item._id">
                                                                    <i class="flaticon2-trash icon-1x text-dark-50"></i>&nbsp; Eliminar                                    
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="modal fade" id="delete-{{item._id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                            <div class="modal-dialog" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-header">
                                                                        <h5 class="modal-title" id="exampleModalLabel">Eliminación Producto</h5>
                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <i aria-hidden="true" class="ki ki-close"></i>
                                                                        </button>
                                                                    </div>
                                                                    <div class="modal-body">
                                                                        <p>¿Desea eliminar el producto?</p>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn btn-warning font-weight-bold" data-dismiss="modal">Cerrar</button>
                                                                        <button *ngIf="load_delete" type="button" class="btn btn-danger font-weight-bold" (click)="eliminar_producto(item._id)">Eliminar</button>
                                                        
                                                                        <button *ngIf="!load_delete" class="btn btn-danger" type="button" disabled>
                                                                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                                                            Enviando...
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                            </tbody>
                                            <tbody *ngIf="producto.length == 0">
                                                <tr>
                                                    <td class="text-center" colspan="5">
                                                        <p class="text-muted">No hay ningun registro que mostrar !!!</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </ng-container>
                                    </table>
                                </div>
                                <!--end::Shopping Cart-->
                            </div>
                            <div class="card-footer">
                                <ngb-pagination
	                                        [collectionSize]="producto.length"
                                            [pageSize]="pageSize"
	                                        [(page)]="page"                                            
	                                        [maxSize]="10"
	                                        [rotate]="true"
	                                        [boundaryLinks]="true"
                                ></ngb-pagination>
                            </div>
                        </div>
                        
                    </div>
                    <!--end::Container-->
                </div>
                <!--end::Entry-->
            </div>
            <div class="modal fade" id="exampleModalCenter" tabindex="-1" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 500px;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Nuevo ingreso</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <i aria-hidden="true" class="ki ki-close"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <h3 class="font-size-lg text-dark font-weight-bold mb-6">1. Producto:</h3>
                            <div class="mb-15">
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">ID Producto (*):</label>
                                    <div class="col-lg-9">
                                        <input type="text" class="form-control" placeholder="Código del Producto" name="codigo" [(ngModel)]="productos.codigo">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Descripción (*):</label>
                                    <div class="col-lg-9">
                                        <input type="text" class="form-control" placeholder="Descripción del Producto" name="descripcion" [(ngModel)]="productos.descripcion">
                                    </div>
                                </div>
                            </div>
                            <h3 class="font-size-lg text-dark font-weight-bold mb-6">1. Ingreso:</h3>
                            <div class="">
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Precio (*):</label>
                                    <div class="col-lg-9">
                                        <input type="number" class="form-control" placeholder="Q 0.00" name="precio" [(ngModel)]="productos.precio">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Tipo (*):</label>
                                    <div class="col-lg-9">
                                        <select class="form-control selectpicker" data-live-search="true" name="tipo" [(ngModel)]="productos.tipo">
                                            <option value="" disabled selected>Seleccionar</option>
                                            <option value="BIEN">BIEN</option>
                                            <option value="SERVICIO">SERVICIO</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Unidad de Medida (?):</label>
                                    <div class="col-lg-9">
                                        <select class="form-control selectpicker" data-live-search="true" name="unidad" [(ngModel)]="productos.unidad">
                                            <option value="" disabled selected>Seleccionar</option>
                                            <option value="TON">TON</option>
                                            <option value="MT2">MT2</option>
                                            <option value="UNO">UNO</option>
                                            <option value="PZA">PZA</option>
                                            <option value="LTR">LTR</option>
                                            <option value="KG">KG</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-light-primary font-weight-bold" data-dismiss="modal">Cerrar</button>
                            <button *ngIf="load_ingresar" type="button" (click)="save()" class="btn btn-primary font-weight-bold">Ingresar</button>
                            <button *ngIf="!load_ingresar" class="btn btn-primary font-weight-bold" type="button" disabled>
                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                Ingresando...
                            </button>
                        </div>
                    </div>
                </div>
            </div>               
            <div class="modal fade" id="exampleModalCenter2" tabindex="-1" aria-labelledby="exampleModalCenter2" style="display: none;" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 500px;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Nuevo ingreso</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <i aria-hidden="true" class="ki ki-close"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <h3 class="font-size-lg text-dark font-weight-bold mb-6">1. Producto:</h3>
                            <div class="mb-15">
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">ID Producto (*):</label>
                                    <div class="col-lg-9">
                                        <input type="text" class="form-control" placeholder="Código del Producto" name="codigo" [(ngModel)]="productos2.codigo">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Descripción (*):</label>
                                    <div class="col-lg-9">
                                        <input type="text" class="form-control" placeholder="Descripción del Producto" name="descripcion" [(ngModel)]="productos2.descripcion">
                                    </div>
                                </div>
                            </div>
                            <h3 class="font-size-lg text-dark font-weight-bold mb-6">1. Ingreso:</h3>
                            <div class="">
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Precio (*):</label>
                                    <div class="col-lg-9">
                                        <input type="number" class="form-control" placeholder="Q 0.00" name="precio" [(ngModel)]="productos2.precio">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Tipo (*):</label>
                                    <div class="col-lg-9">
                                        <select class="form-control selectpicker" data-live-search="true" name="tipo" [(ngModel)]="productos2.tipo">
                                            <option value="" disabled selected>Seleccionar</option>
                                            <option value="BIEN">BIEN</option>
                                            <option value="SERVICIO">SERVICIO</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-lg-3 col-form-label text-left">Unidad de Medida (?):</label>
                                    <div class="col-lg-9">
                                        <select class="form-control selectpicker" data-live-search="true" name="unidad" [(ngModel)]="productos2.unidad">
                                            <option value="" disabled selected>Seleccionar</option>
                                            <option value="TON">TON</option>
                                            <option value="MT2">MT2</option>
                                            <option value="UNO">UNO</option>
                                            <option value="PZA">PZA</option>
                                            <option value="LTR">LTR</option>
                                            <option value="KG">KG</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-light-primary font-weight-bold" data-dismiss="modal">Cerrar</button>
                            <button type="button" (click)="actualizar()" class="btn btn-primary font-weight-bold">Actualizar</button>
                        </div>
                    </div>
                </div>
            </div> 
            <!--end::Content-->
        </div>
    </div>
</div>
